# RateMate

- Проект, который умеет загружать информацию о валюте через консольную команду, а также в случае, если валюта набирает популярность - **догружаться самостоятельно**.
- Помимо того, на основе загруженных курсов валют он может легко их конвертировать.

### Мысли вслух (не обязательно к прочтению)

Изначально хотел сделать проект как API с отдельным SPA приложением. Однако из-за того, что я ранее писал в основном на Laravel и не работал с Symfony, достаточно много времени потратил на изучение фреймворка.

В частности, прочитал книгу Symfony 5. Быстрый старт - Fabien Potencier. Да, я понимаю, что сейчас актуальна версия 7, однако в интернете я нашел только пятую версию.

Смею предположить, что фреймворк не сильно изменился за этот период. Основные изменения связаны с поддержкой новых функций языка. Нативная поддержка атрибутов достаточно приятна.

Кстати, сама книга достаточно поверхностная. Скорее из серии "проедемся по верхам, расскажем о фишках", но не глубоко разбираемся.


### О технической реализации проекта

- В контроллере, при получении списка курсов валют по отношению к базовой валюте, решил дать возможность загрузить их через очереди/сообщения в фоне. Если сервер в первый раз сообщит 404 "Попробуйте через несколько минут", то при следующей загрузке валюты они должны будут загрузиться. Можно было бы сделать все в рамках одного запроса, но я не хотел увеличивать таймаут, и по факту он работает синхронно.

- На сайте ресурсов, откуда я загружаю курсы валют, я взял списки базовых валют, которые поместил в Enum. Они действительно сильно пригодились для дополнительных проверок:
    - не загружать HTTP клиенты и не использовать свой rateLimit в лишний раз, если API не поддерживает эту валюту;
    - используются при конвертации для избежания лишних операций;
    - также в контроллере для валидации при запросе списка курсов для базовой валюты.
- Также в проекте есть Postman-коллекция, которую я использовал для тестирования моего приложения.


### Пререквизиты перед установкой

- PHP 8.2 или выше должен быть установлен на локальной машине.
- Composer.
- Ну, собственно, все.

Если честно, я привык все помещать в контейнеры, но в данном случае не стал мудрить. Подумал, кто его знает, какие зависимости понадобятся еще. Хотя все оказалось достаточно простым.

Не стал подключать message-broker, и в проекте все работает синхронно, хотя он, конечно же, расчитан на асинхронность.

### Установка и запуск проекта

1. Клонировать проект
   ```bash
   git clone git@github.com:maralbars/RateMate.git
   ```

2. Перейти в папку
   ```bash
   cd RateMate
   ```

3. Установить зависимости
   ```bash
   composer install
   ```

4. Запустить веб-сервер
   ```bash
   symfony server:start
   ```

5. Посмотреть в консоли, на каком порту он запустился. По умолчанию он должен запуститься на http://localhost:8000.

### Как запустить консольную команду для загрузки валют?

Просто выполните:
   ```bash
   symfony console app:get-rates
   ```

По умолчанию будет загружен USD, однако мы можем явно указать валюту:
   ```bash
   symfony console app:get-rates KZT
   ```


### Итого

В целом все. Я старался выполнить все хорошо, несмотря на незнакомый мне фреймворк. Надеюсь, вам понравится :)
